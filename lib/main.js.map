{"version":3,"sources":["../src/main.js"],"names":["rootDir","process","cwd","MorphineJs","constructor","initDb","DbMysql","init","Config","mysql","executeMigration","Migration","update","initExpress","initMiddlewares","initHttpServer","initResSendData","req","res","next","Services","ErrorCodes","sendData","errorKeyOrData","status","data","err","getErrorCode","meta","send","notFound","start","httpserver"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA;;AACA;;AAEA;;AACA;;AACA;;AACA;;AAEA;;;;;;AACA;AAEA,IAAMA,OAAO,GAAGC,OAAO,CAACC,GAAR,EAAhB;;AAEA,IAAMC,UAAU,GAAG,MAAM;AACxBC,EAAAA,WAAW,GAAG,CAAE;;AAEVC,EAAAA,MAAM,GAAG;AAAA;AACd,YAAMC,iBAAQC,IAAR,CAAaC,eAAOC,KAApB,CAAN;AADc;AAEd;;AACKC,EAAAA,gBAAgB,GAAG;AAAA;AACxBC,yBAAUC,MAAV;AADwB;AAExB;;AACKC,EAAAA,WAAW,GAAG;AAAA;AAAE;;AAChBC,EAAAA,eAAe,GAAG;AAAA;AAAE;;AACpBC,EAAAA,cAAc,GAAG;AAAA;AAAE;;AACzBC,EAAAA,eAAe,GAAG;AACjB,WAAO,UAAUC,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AAChC,UAAI,CAACC,mBAASC,UAAd,EAA0B,OAAOF,IAAI,EAAX;;AAC1BD,MAAAA,GAAG,CAACI,QAAJ,GAAe,UAAUC,cAAV,EAAwC;AAAA,YAAdC,MAAc,uEAAL,GAAK;AACtD;AACA,YAAIC,IAAJ;AACAF,QAAAA,cAAc,GAAGA,cAAc,IAAI,EAAnC;;AACA,YAAIA,cAAc,IAAI,OAAOA,cAAP,KAA0B,QAAhD,EAA0D;AACzDE,UAAAA,IAAI,GAAG;AAAEC,YAAAA,GAAG,EAAEN,mBAASC,UAAT,CAAoBM,YAApB,CAAiCJ,cAAjC;AAAP,WAAP;AACAC,UAAAA,MAAM,GAAGC,IAAI,CAACC,GAAL,CAASF,MAAlB;AACA,SAHD,MAGO;AACNC,UAAAA,IAAI,GAAGF,cAAP;AACAE,UAAAA,IAAI,CAACC,GAAL,GAAW,IAAX;AACA,cAAI,CAACD,IAAI,CAACG,IAAV,EAAgBH,IAAI,CAACG,IAAL,GAAY,EAAZ;AAChB;;AACDV,QAAAA,GAAG,CAACM,MAAJ,CAAWA,MAAX,EAAmBK,IAAnB,CAAwBJ,IAAxB;AACA,OAbD;;AAcAN,MAAAA,IAAI;AACJ,KAjBD;AAkBA,GA/BuB,CAgCxB;AACA;AACA;AACA;AACA;AACA;AACA;;;AACMW,EAAAA,QAAQ,GAAG;AAAA;AAAE;;AAEbC,EAAAA,KAAK,GAAG;AAAA;;AAAA;AACb,YAAM,KAAI,CAAC1B,MAAL,EAAN;AACA,YAAM,KAAI,CAACK,gBAAL,EAAN,CAFa,CAGb;;AACA,YAAM,KAAI,CAACG,WAAL,EAAN;AACA,YAAM,KAAI,CAACC,eAAL,EAAN,CALa,CAMb;;AACA,MAAA,KAAI,CAACkB,UAAL,SAAwB,KAAI,CAACjB,cAAL,EAAxB;AAPa;AAQb;;AAjDuB,CAAzB","sourcesContent":["// import path from \"path\";\n\nimport { App } from \"./App\";\nimport { Services, Service, loadServices } from \"./Services\";\n// console.log(\"Services\", Services);\nimport { Config } from \"./Config\";\nimport { Controller, loadControllers } from \"./Controller\";\nimport { Get, Post, Put, Delete, Crud } from \"./MethodDecorators\";\nimport { Middlewares, Middleware, loadRoutesMiddlewares } from \"./Middlewares\";\n\nimport { DbMysql, Model, Models, Migration } from \"./DbMysql\";\n// const Models = DbMysql.models;\n\nconst rootDir = process.cwd();\n\nconst MorphineJs = class {\n\tconstructor() {}\n\n\tasync initDb() {\n\t\tawait DbMysql.init(Config.mysql);\n\t}\n\tasync executeMigration() {\n\t\tMigration.update();\n\t}\n\tasync initExpress() {}\n\tasync initMiddlewares() {}\n\tasync initHttpServer() {}\n\tinitResSendData() {\n\t\treturn function (req, res, next) {\n\t\t\tif (!Services.ErrorCodes) return next();\n\t\t\tres.sendData = function (errorKeyOrData, status = 200) {\n\t\t\t\t// console.log(\"this\", this);\n\t\t\t\tlet data;\n\t\t\t\terrorKeyOrData = errorKeyOrData || {};\n\t\t\t\tif (errorKeyOrData && typeof errorKeyOrData === \"string\") {\n\t\t\t\t\tdata = { err: Services.ErrorCodes.getErrorCode(errorKeyOrData) };\n\t\t\t\t\tstatus = data.err.status;\n\t\t\t\t} else {\n\t\t\t\t\tdata = errorKeyOrData;\n\t\t\t\t\tdata.err = null;\n\t\t\t\t\tif (!data.meta) data.meta = {};\n\t\t\t\t}\n\t\t\t\tres.status(status).send(data);\n\t\t\t};\n\t\t\tnext();\n\t\t};\n\t}\n\t// async initMyMiddlewares() {\n\t// \tawait loadMiddlewares();\n\t// }\n\t// async initControllers() {\n\t// \tawait loadControllers();\n\t// \tawait this.notFound();\n\t// }\n\tasync notFound() {}\n\n\tasync start() {\n\t\tawait this.initDb();\n\t\tawait this.executeMigration();\n\t\t// await loadServices();\n\t\tawait this.initExpress();\n\t\tawait this.initMiddlewares();\n\t\t// this.initResSendData();\n\t\tthis.httpserver = await this.initHttpServer();\n\t}\n};\n\nexport {\n\trootDir,\n\tMorphineJs,\n\tConfig,\n\tApp,\n\tController,\n\tCrud,\n\tGet,\n\tPost,\n\tPut,\n\tDelete,\n\tDbMysql,\n\tModels,\n\tModel,\n\tServices,\n\tService,\n\tMiddleware,\n\tMiddlewares,\n\tMigration,\n\tloadRoutesMiddlewares,\n\tloadControllers,\n\tloadServices,\n};\n"],"file":"main.js"}