{"version":3,"sources":["../src/DbTableExec.js"],"names":["_","require","dayjs","module","exports","DbTableExec","constructor","table","DbMysql","def","modelname","selected","command","connection","primary","primaryType","primaryLength","where","whereData","onlyOne","order","having","groupby","tabAlreadyIncluded","logQuery","catchErr","iscount","joinModels","fieldJoin","modelnameto","modelalias","fieldName","field","Object","entries","attributes","type","length","select","fields","find","undefined","count","findone","create","data","cloneDeep","what","JSON","parse","stringify","update","original_where","original_whereData","updateone","query","querySaved","destroy","_searchModelFromFieldName","fromModelName","f","models","model","log","catchError","populate","fieldJoinName","tabFieldsJoins","split","previousModelName","previousModelAlias","tabOrigin","forEach","join","push","modeltolink","modelaliasto","origin","alias","orderBy","groupBy","_createWhere","fromUpdate","Number","isInteger","isKey","indexOf","concat","index","key","val","_createSelect","tabSelect","each","num","as","_createJoin","tabJoin","tableName","_createOrder","_createSelectQuery","_createInsertQuery","vals","autoincrement","hasOwnProperty","defaultsTo","_createUpdateQuery","_createDestroyQuery","_preTreatment","isObject","e","console","warn","Date","format","m","isValid","_postTreatment","rows","row","obj","previousObj","lastO","o","_beforeQuery","fn","fn2","useUpdatedAt","updatedAt","updatedAtForced","beforeUpdate","beforeDestroy","useCreatedAt","createdAt","createdAtForced","beforeCreate","beforeSelect","exec","cb","returnCompleteRow","isBoolean","debug","error","postTreatmentMain","res","insertId","affectedRows","cmpt","rows2","ftemp"],"mappings":"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","sourcesContent":["// var DbMysql = require(\"./DbMysql.server\");\nvar _ = require(\"lodash\");\nvar dayjs = require(\"dayjs\");\n// console.log(\"DbMysql\", DbMysql);\n\nmodule.exports = class DbTableExec {\n\tconstructor(table) {\n\t\tthis.DbMysql = table.DbMysql;\n\t\tthis.table = table;\n\t\tthis.def = table.def;\n\t\tthis.modelname = this.def.modelname;\n\t\tthis.selected = [];\n\t\tthis.command = \"SELECT\";\n\t\tthis.connection = table.connection;\n\t\tthis.primary = \"id\";\n\t\tthis.primaryType = \"integer\";\n\t\tthis.primaryLength = 11;\n\t\tthis.where = \"\";\n\t\tthis.whereData = [];\n\t\tthis.onlyOne = false;\n\t\tthis.order = \"\";\n\t\tthis.having = \"\";\n\t\tthis.groupby = \"\";\n\t\tthis.tabAlreadyIncluded = {};\n\t\tthis.logQuery = false;\n\t\tthis.catchErr = false;\n\t\tthis.iscount = false;\n\t\tthis.joinModels = [{ modelname: this.modelname, fieldJoin: null, modelnameto: null, modelalias: \"t1\" }];\n\t\tfor (const [fieldName, field] of Object.entries(this.def.attributes)) {\n\t\t\tif (field.primary) {\n\t\t\t\tthis.primary = fieldName;\n\t\t\t\tthis.primaryType = field.type;\n\t\t\t\tthis.primaryLength = field.length;\n\t\t\t}\n\t\t}\n\t}\n\tselect(fields) {\n\t\tthis.selected = fields;\n\t\treturn this;\n\t}\n\tfind(where, whereData) {\n\t\tthis.command = \"SELECT\";\n\t\tthis.onlyOne = false;\n\t\tthis.where = where;\n\t\tif (whereData === undefined) this.whereData = [];\n\t\telse this.whereData = whereData;\n\t\treturn this;\n\t}\n\tcount(where, whereData) {\n\t\tthis.iscount = true;\n\t\treturn this.find(where, whereData);\n\t}\n\tfindone(where, whereData) {\n\t\tthis.onlyOne = true;\n\t\tthis.where = where;\n\t\tif (whereData === undefined) this.whereData = [];\n\t\telse this.whereData = whereData;\n\t\treturn this;\n\t}\n\tcreate(data) {\n\t\tthis.onlyOne = false;\n\t\tthis.command = \"INSERT\";\n\t\tthis.data = data;\n\t\treturn this;\n\t}\n\tcloneDeep(what) {\n\t\treturn JSON.parse(JSON.stringify(what));\n\t}\n\tupdate(where, whereData, data) {\n\t\tif (data === undefined) {\n\t\t\tdata = whereData;\n\t\t\tthis.whereData = [];\n\t\t} else {\n\t\t\tthis.whereData = whereData;\n\t\t}\n\t\tthis.original_where = this.cloneDeep(where);\n\t\tthis.original_whereData = this.cloneDeep(this.whereData);\n\t\tthis.whereData = [];\n\n\t\tthis.onlyOne = false;\n\t\tthis.command = \"UPDATE\";\n\t\tthis.where = where;\n\t\tthis.data = data;\n\t\treturn this;\n\t}\n\tupdateone(where, whereData, data) {\n\t\tthis.update(where, whereData, data);\n\t\tthis.onlyOne = true;\n\t\treturn this;\n\t}\n\tquery(query, data) {\n\t\tthis.command = \"QUERY\";\n\t\tthis.whereData = data;\n\t\tthis.querySaved = query;\n\t\treturn this;\n\t}\n\tdestroy(where, whereData = []) {\n\t\tthis.whereData = whereData;\n\t\tthis.onlyOne = false;\n\t\tthis.command = \"DELETE\";\n\t\tthis.where = where;\n\t\treturn this;\n\t}\n\t_searchModelFromFieldName(fieldJoin, fromModelName) {\n\t\tvar f = null;\n\t\tfor (const [fieldName, field] of Object.entries(this.DbMysql.models[fromModelName].def.attributes)) {\n\t\t\tif (fieldName == fieldJoin && field.model) f = field;\n\t\t}\n\t\treturn f;\n\t}\n\tlog() {\n\t\tthis.logQuery = true;\n\t\treturn this;\n\t}\n\tcatchError() {\n\t\tthis.catchErr = true;\n\t\treturn this;\n\t}\n\tpopulate(fieldJoin, fieldJoinName) {\n\t\t// console.log(\"this.table\", this.table);\n\t\tlet tabFieldsJoins = fieldJoin.split(\".\");\n\t\tlet previousModelName = this.modelname;\n\t\tlet previousModelAlias = \"t1\";\n\t\tlet tabOrigin = [];\n\t\ttabFieldsJoins.forEach((join) => {\n\t\t\ttabOrigin.push(join);\n\t\t\tlet modeltolink = this._searchModelFromFieldName(join, previousModelName);\n\t\t\t// console.log(\"modeltolink\", modeltolink);\n\t\t\tlet modelalias = \"t1\";\n\t\t\tif (modeltolink) {\n\t\t\t\tif (!this.tabAlreadyIncluded[modeltolink.model + \"__\" + tabOrigin.join(\"_\")]) {\n\t\t\t\t\tmodelalias = \"t\" + (this.joinModels.length + 1);\n\t\t\t\t\tthis.joinModels.push({\n\t\t\t\t\t\tmodelname: modeltolink.model,\n\t\t\t\t\t\tmodelalias: modelalias,\n\t\t\t\t\t\tfieldJoin: join,\n\t\t\t\t\t\tmodelnameto: previousModelName,\n\t\t\t\t\t\tmodelaliasto: previousModelAlias,\n\t\t\t\t\t\torigin: tabOrigin.join(\".\"),\n\t\t\t\t\t\tfieldJoinName: fieldJoinName || modeltolink.alias || null,\n\t\t\t\t\t});\n\t\t\t\t\tthis.tabAlreadyIncluded[modeltolink.model + \"__\" + tabOrigin.join(\"_\")] = modelalias;\n\t\t\t\t} else {\n\t\t\t\t\tmodelalias = this.tabAlreadyIncluded[modeltolink.model + \"__\" + tabOrigin.join(\"_\")];\n\t\t\t\t}\n\t\t\t}\n\t\t\tpreviousModelName = modeltolink.model;\n\t\t\tpreviousModelAlias = modelalias;\n\t\t});\n\t\treturn this;\n\t}\n\torderBy(order) {\n\t\tthis.order = order;\n\t\treturn this;\n\t}\n\tgroupBy(groupby) {\n\t\tthis.groupby = groupby;\n\t\treturn this;\n\t}\n\thaving(having) {\n\t\tthis.having = having;\n\t\treturn this;\n\t}\n\t_createWhere(fromUpdate) {\n\t\tlet where = \"\";\n\t\tif (!this.where) {\n\t\t\twhere = \"1=1\";\n\t\t} else if (Number.isInteger(this.where)) {\n\t\t\twhere += this.primary + \"=?\";\n\t\t\tthis.whereData.push(this.where);\n\t\t} else if (typeof this.where === \"string\") {\n\t\t\tvar isKey = true;\n\t\t\tif (this.where.indexOf(\" \") !== -1) isKey = false;\n\t\t\tif (this.where.indexOf(\">\") !== -1) isKey = false;\n\t\t\tif (this.where.indexOf(\"<\") !== -1) isKey = false;\n\t\t\tif (this.where.indexOf(\"=\") !== -1) isKey = false;\n\t\t\tif (isKey) {\n\t\t\t\twhere += this.primary + \"=?\";\n\t\t\t\tthis.whereData.push(this.where);\n\t\t\t} else {\n\t\t\t\twhere = this.where;\n\t\t\t\tif (fromUpdate) {\n\t\t\t\t\tthis.whereData = this.whereData.concat(this.original_whereData);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\twhere += \"1\";\n\t\t\tObject.entries(this.where).forEach(([key, val], index) => {\n\t\t\t\twhere += \" && \" + key + \"=?\";\n\t\t\t\tthis.whereData.push(val);\n\t\t\t});\n\t\t}\n\n\t\treturn where;\n\t}\n\t_createSelect() {\n\t\tvar tabSelect = [];\n\t\t_.each(this.joinModels, (model, num) => {\n\t\t\tfor (const [fieldName] of Object.entries(this.DbMysql.models[model.modelname].def.attributes)) {\n\t\t\t\tlet as = \"\";\n\t\t\t\tif (model.modelnameto) as = \" AS \" + model.modelalias + \"_\" + model.fieldJoin + \"_\" + fieldName;\n\t\t\t\ttabSelect.push(model.modelalias + \".\" + fieldName + as);\n\t\t\t}\n\t\t});\n\t\t// console.log(\"tabSelect\", tabSelect);\n\t\tif (this.selected.length) tabSelect = this.selected;\n\t\treturn tabSelect.join(\", \");\n\t}\n\t_createJoin() {\n\t\tlet tabJoin = [];\n\t\t_.each(this.joinModels, (model, num) => {\n\t\t\tif (!model.modelnameto) tabJoin.push(this.DbMysql.models[model.modelname].def.tableName + \" \" + model.modelalias);\n\t\t\telse\n\t\t\t\ttabJoin.push(\n\t\t\t\t\t\"LEFT JOIN \" +\n\t\t\t\t\t\tthis.DbMysql.models[model.modelname].def.tableName +\n\t\t\t\t\t\t\" \" +\n\t\t\t\t\t\tmodel.modelalias +\n\t\t\t\t\t\t\" ON \" +\n\t\t\t\t\t\tmodel.modelalias +\n\t\t\t\t\t\t\".\" +\n\t\t\t\t\t\tthis.DbMysql.models[model.modelname].primary +\n\t\t\t\t\t\t\"=\" +\n\t\t\t\t\t\tmodel.modelaliasto +\n\t\t\t\t\t\t\".\" +\n\t\t\t\t\t\tmodel.fieldJoin\n\t\t\t\t);\n\t\t});\n\t\treturn tabJoin.join(\" \");\n\t}\n\t_createOrder() {\n\t\tlet order = \"\";\n\t\tif (this.order) order = \" ORDER BY \" + this.order;\n\t\treturn order;\n\t}\n\t_createSelectQuery() {\n\t\tlet query = \"SELECT \" + this._createSelect() + \" FROM \" + this._createJoin() + \" WHERE \" + this._createWhere() + this._createOrder();\n\t\tif (this.iscount) {\n\t\t\tquery =\n\t\t\t\t\"SELECT count(t1.\" + this.primary + \") as cmpt FROM \" + this._createJoin() + \" WHERE \" + this._createWhere() + this._createOrder();\n\t\t\t// console.log(\"query\", query);\n\t\t}\n\t\t// console.log(\"query\", query);\n\t\treturn query;\n\t}\n\t_createInsertQuery() {\n\t\tlet fields = [],\n\t\t\tvals = [];\n\t\t// _.each(this.data, (val, key) => {\n\t\t// \tif (this.def.attributes[key]) {\n\t\t// \t\tfields.push(key);\n\t\t// \t\tvals.push(\"?\");\n\t\t// \t\tthis.whereData.push(val);\n\t\t// \t}\n\t\t// });\n\n\t\tfor (const [key, val] of Object.entries(this.def.attributes)) {\n\t\t\tif (val.primary && val.autoincrement) return;\n\t\t\tfields.push(key);\n\t\t\tvals.push(\"?\");\n\t\t\tif (this.data.hasOwnProperty(key)) {\n\t\t\t\tthis.whereData.push(this.data[key]);\n\t\t\t} else {\n\t\t\t\tif (val.defaultsTo) this.whereData.push(val.defaultsTo);\n\t\t\t\telse {\n\t\t\t\t\tif (\n\t\t\t\t\t\tval.type == \"int\" ||\n\t\t\t\t\t\tval.type == \"integer\" ||\n\t\t\t\t\t\tval.type == \"tinyint\" ||\n\t\t\t\t\t\tval.type == \"smallint\" ||\n\t\t\t\t\t\tval.type == \"mediumint\" ||\n\t\t\t\t\t\tval.type == \"year\" ||\n\t\t\t\t\t\tval.type == \"float\" ||\n\t\t\t\t\t\tval.type == \"double\" ||\n\t\t\t\t\t\tval.type == \"boolean\"\n\t\t\t\t\t)\n\t\t\t\t\t\tthis.whereData.push(0);\n\t\t\t\t\telse this.whereData.push(\"\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tlet query = \"INSERT INTO \" + this.def.tableName + \"(\" + fields.join(\", \") + \") VALUES (\" + vals.join(\", \") + \")\";\n\t\t// console.log(\"query\", query, this.data);\n\t\treturn query;\n\t}\n\t_createUpdateQuery() {\n\t\tlet vals = [];\n\t\t_.each(this.data, (val, key) => {\n\t\t\tif (this.def.attributes[key]) {\n\t\t\t\tvals.push(key + \"=?\");\n\t\t\t\tthis.whereData.push(val);\n\t\t\t}\n\t\t});\n\t\t// this.original_where, this.original_whereData\n\t\tlet query = \"UPDATE \" + this.def.tableName + \" SET \" + vals.join(\", \") + \" WHERE \" + this._createWhere(true);\n\t\treturn query;\n\t}\n\t_createDestroyQuery() {\n\t\tlet query = \"DELETE FROM \" + this.def.tableName + \" WHERE \" + this._createWhere();\n\t\treturn query;\n\t}\n\t_preTreatment() {\n\t\t// console.log(\"this.data\",this.data);\n\n\t\tfor (const [fieldName, field] of Object.entries(this.def.attributes)) {\n\t\t\t// console.log(\"fieldName,field.type\",fieldName,field.type);\n\t\t\tif (this.data[fieldName] === undefined) return;\n\t\t\tlet key = fieldName;\n\t\t\tlet val = this.data[key];\n\t\t\tif (field.type == \"json\" && _.isObject(val)) {\n\t\t\t\ttry {\n\t\t\t\t\tthis.data[key] = JSON.stringify(this.data[key]);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.warn(\"json stringify error\", e);\n\t\t\t\t\tthis.data[key] = \"\";\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (field.type == \"json\" && !_.isObject(val)) {\n\t\t\t\ttry {\n\t\t\t\t\tthis.data[key] = JSON.parse(this.data[key]);\n\t\t\t\t\t// console.log(\"this.data[key]\",this.data[key]);\n\t\t\t\t} catch (e) {\n\t\t\t\t\t// console.log(\"json stringify error\",e);\n\t\t\t\t}\n\t\t\t\ttry {\n\t\t\t\t\tthis.data[key] = JSON.stringify(this.data[key]);\n\t\t\t\t\t// console.log(\"this.data[key]\",this.data[key]);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.warn(\"json stringify error\", e);\n\t\t\t\t\tthis.data[key] = \"\";\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (field.type == \"boolean\") {\n\t\t\t\tif (this.data[fieldName] === false) this.data[fieldName] = 0;\n\t\t\t\tif (this.data[fieldName] === true) this.data[fieldName] = 1;\n\t\t\t\tif (this.data[fieldName] === \"false\") this.data[fieldName] = 0;\n\t\t\t\tif (this.data[fieldName] === \"true\") this.data[fieldName] = 1;\n\t\t\t}\n\t\t\tif (field.type == \"datetime\" && this.data[fieldName]) {\n\t\t\t\tthis.data[fieldName] = dayjs(new Date(this.data[fieldName])).format(\"YYYY-MM-DD HH:mm:ss\");\n\t\t\t}\n\t\t\tif (field.type == \"date\" && this.data[fieldName]) {\n\t\t\t\tlet m = dayjs(new Date(this.data[fieldName]));\n\t\t\t\tif (this.data[fieldName] == \"0000-00-00\" || this.data[fieldName] == \"\" || !m.isValid()) this.data[fieldName] = \"0000-00-00\";\n\t\t\t\telse this.data[fieldName] = m.format(\"YYYY-MM-DD\");\n\t\t\t}\n\t\t\tif (field.type == \"datetime\" && this.data[fieldName]) {\n\t\t\t\tlet m = dayjs(new Date(this.data[fieldName]));\n\t\t\t\tif (\n\t\t\t\t\tthis.data[fieldName] == \"0000-00-00\" ||\n\t\t\t\t\tthis.data[fieldName] == \"0000-00-00 00:00:00\" ||\n\t\t\t\t\tthis.data[fieldName] == \"\" ||\n\t\t\t\t\t!m.isValid()\n\t\t\t\t)\n\t\t\t\t\tthis.data[fieldName] = \"0000-00-00 00:00:00\";\n\t\t\t\telse this.data[fieldName] = m.format(\"YYYY-MM-DD HH:mm:ss\");\n\t\t\t}\n\t\t\t// if (field.type == \"datetime\") {\n\t\t\t// \tif (_.isDate(this.data[fieldName])) this.data[fieldName] = moment(this.data[fieldName]).format(\"YYYY-MM-DD HH:mm:ss\");\n\t\t\t// }\n\t\t\t// if (field.type == \"date\") {\n\t\t\t// \tif (_.isDate(this.data[fieldName])) this.data[fieldName] = moment(this.data[fieldName]).format(\"YYYY-MM-DD\");\n\t\t\t// }\n\t\t}\n\t}\n\t_postTreatment(rows) {\n\t\t// if (this.iscount) console.log(\"rows\", rows);\n\t\t_.each(rows, (row) => {\n\t\t\tfor (const [fieldName, field] of Object.entries(this.def.attributes)) {\n\t\t\t\tif (field.type == \"json\") {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (row[fieldName]) row[fieldName] = JSON.parse(row[fieldName]);\n\t\t\t\t\t\telse row[fieldName] = null;\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tconsole.warn(`json parse error - fieldName:\"${fieldName}\" - value:\"${row[fieldName]}\"`);\n\t\t\t\t\t\trow[fieldName] = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (field.type == \"boolean\") {\n\t\t\t\t\tif (row[fieldName] === true || row[fieldName] === \"true\" || row[fieldName] === 1 || row[fieldName] === \"1\") row[fieldName] = true;\n\t\t\t\t\telse row[fieldName] = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// let alreadyOrigins = [];\n\t\t\t_.each(this.joinModels, (model, num) => {\n\t\t\t\tif (model.modelnameto) {\n\t\t\t\t\t// this._setObjectToRow(row, row, model.modelname, model.modelnameto, model.fieldJoin) ;\n\t\t\t\t\tlet obj = {};\n\n\t\t\t\t\tfor (const [fieldName, field] of Object.entries(this.DbMysql.models[model.modelname].def.attributes)) {\n\t\t\t\t\t\t// let f = DbMysql.models[model.modelname].def.tableName+'_'+model.fieldJoin+'_'+fieldName ;\n\t\t\t\t\t\tlet f = model.modelalias + \"_\" + model.fieldJoin + \"_\" + fieldName;\n\t\t\t\t\t\tif (row.hasOwnProperty(f)) {\n\t\t\t\t\t\t\tif (field.type == \"json\") {\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tif (row[f]) row[f] = JSON.parse(row[f]);\n\t\t\t\t\t\t\t\t\telse row[f] = null;\n\t\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\t\tconsole.warn(\"json parse error\", e, f, row[f]);\n\t\t\t\t\t\t\t\t\trow[f] = null;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tobj[fieldName] = row[f];\n\t\t\t\t\t\t\tdelete row[f];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// console.log(\"model.fieldJoinName\", model.fieldJoinName);\n\t\t\t\t\tif (model.fieldJoinName) {\n\t\t\t\t\t\trow[model.fieldJoinName] = obj;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (!obj[this.DbMysql.models[model.modelname].primary]) {\n\t\t\t\t\t\t\t// console.log(\"M_Db.models[model.modelname].primary\",M_Db.models[model.modelname].primary, obj);\n\t\t\t\t\t\t\tobj = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlet tabFieldsJoins = model.origin.split(\".\");\n\t\t\t\t\t\tlet previousObj = row;\n\t\t\t\t\t\tlet lastO = null;\n\t\t\t\t\t\t_.each(tabFieldsJoins, (o, index) => {\n\t\t\t\t\t\t\tlastO = o;\n\t\t\t\t\t\t\tif (index >= tabFieldsJoins.length - 1) return;\n\t\t\t\t\t\t\tpreviousObj = previousObj[o];\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (previousObj) previousObj[lastO] = obj;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\tasync _beforeQuery() {\n\t\tlet fn = null,\n\t\t\tfn2 = null;\n\t\tswitch (this.command) {\n\t\t\tcase \"UPDATE\":\n\t\t\t\t// if (this.def.useUpdatedAt && !this.data.updatedAt) this.data.updatedAt = new Date();\n\t\t\t\tif (this.def.useUpdatedAt) this.data.updatedAt = new Date();\n\t\t\t\tif (this.data.updatedAtForced) this.data.updatedAt = this.data.updatedAtForced;\n\t\t\t\tif (this.def.beforeUpdate) fn = this.def.beforeUpdate;\n\t\t\t\tbreak;\n\t\t\tcase \"DELETE\":\n\t\t\t\tif (this.def.beforeDestroy) fn2 = this.def.beforeDestroy;\n\t\t\t\tbreak;\n\t\t\tcase \"INSERT\":\n\t\t\t\t// if (this.def.useCreatedAt && !this.data.createdAt) this.data.createdAt = new Date();\n\t\t\t\t// if (this.def.useUpdatedAt && !this.data.updatedAt) this.data.updatedAt = new Date();\n\t\t\t\tif (this.def.useCreatedAt) this.data.createdAt = new Date();\n\t\t\t\tif (this.def.useUpdatedAt) this.data.updatedAt = new Date();\n\t\t\t\tif (this.data.createdAtForced) this.data.createdAt = this.data.createdAtForced;\n\t\t\t\tif (this.data.updatedAtForced) this.data.updatedAt = this.data.updatedAtForced;\n\t\t\t\tif (this.def.beforeCreate) fn = this.def.beforeCreate;\n\t\t\t\tbreak;\n\t\t\t// case 'REPLACE':\n\t\t\t// if (this.def.beforeCreate) fn = this.def.beforeCreate ;\n\t\t\t// break;\n\t\t\tdefault:\n\t\t\t\tif (this.def.beforeSelect) fn = this.def.beforeSelect;\n\t\t}\n\t\tif (fn) await fn(this.data);\n\t\telse if (fn2) await fn();\n\t}\n\t// async aexec(returnCompleteRow) {\n\t// \treturn new Promise((resolve, reject) => {\n\t// \t\tthis.exec(data => {\n\t// \t\t\tresolve(data);\n\t// \t\t}, returnCompleteRow);\n\t// \t});\n\t// }\n\tasync exec(cb, returnCompleteRow) {\n\t\tif (_.isBoolean(cb) || cb === undefined) {\n\t\t\treturnCompleteRow = cb;\n\t\t\tcb = null;\n\t\t}\n\t\t// console.log(\"cb\", cb);\n\n\t\t// console.log(\"this.command,this.data\",this.command,this.data);\n\t\tthis._beforeQuery();\n\t\t// console.log(\"after\");\n\t\tlet query;\n\t\tswitch (this.command) {\n\t\t\tcase \"QUERY\":\n\t\t\t\tquery = this.querySaved;\n\t\t\t\tbreak;\n\t\t\tcase \"INSERT\":\n\t\t\t\tthis._preTreatment();\n\t\t\t\tquery = this._createInsertQuery();\n\t\t\t\tbreak;\n\t\t\tcase \"UPDATE\":\n\t\t\t\tthis._preTreatment();\n\t\t\t\tquery = this._createUpdateQuery();\n\t\t\t\tbreak;\n\t\t\tcase \"DELETE\":\n\t\t\t\tquery = this._createDestroyQuery();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tquery = this._createSelectQuery();\n\t\t}\n\n\t\tif (this.def.debug || this.logQuery) console.warn(\"query\", query, this.whereData);\n\t\tlet rows;\n\t\ttry {\n\t\t\trows = await this.connection.query(query, this.whereData, this.catchErr);\n\t\t} catch (error) {\n\t\t\tthrow error;\n\t\t}\n\t\tlet data = this.postTreatmentMain(rows, returnCompleteRow);\n\t\treturn data;\n\t\t// }\n\t}\n\tpostTreatmentMain(rows, returnCompleteRow, cb) {\n\t\t// if (returnCompleteRow) console.log(\"postTreatmentMain\", rows);\n\t\tlet res;\n\t\t// console.log(\"rows\", rows);\n\t\tif (!rows) {\n\t\t\t// console.log('query',query);\n\t\t\t// console.log('whereData',this.whereData);\n\t\t\t// console.warn(\"err\", rows);\n\t\t\tres = {};\n\t\t\tswitch (this.command) {\n\t\t\t\tcase \"QUERY\":\n\t\t\t\t\tres = [];\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"UPDATE\":\n\t\t\t\t\tres = 0;\n\t\t\t\t\tif (returnCompleteRow) res = {};\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"DELETE\":\n\t\t\t\t\tres = 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"INSERT\":\n\t\t\t\t\tthis.data[this.primary] = rows.insertId;\n\t\t\t\t\t// res = this.data ;\n\t\t\t\t\tres = \"\";\n\t\t\t\t\tif (returnCompleteRow) res = {};\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tres = {};\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\treturn res;\n\t\t}\n\t\tswitch (this.command) {\n\t\t\tcase \"QUERY\":\n\t\t\t\tres = rows;\n\t\t\t\tbreak;\n\t\t\tcase \"UPDATE\":\n\t\t\t\tres = rows.affectedRows;\n\t\t\t\t// console.log(\"rows\",rows);\n\t\t\t\tbreak;\n\t\t\tcase \"DELETE\":\n\t\t\t\tres = rows.affectedRows;\n\t\t\t\tbreak;\n\t\t\tcase \"INSERT\":\n\t\t\t\t// this.data[this.primary] = rows.insertId;\n\t\t\t\t// res = this.data ;\n\t\t\t\tres = rows.insertId;\n\t\t\t\tif (res) this.data[this.primary] = rows.insertId;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tif (this.iscount) res = rows[0].cmpt;\n\t\t\t\telse {\n\t\t\t\t\tthis._postTreatment(rows);\n\t\t\t\t\tif (this.onlyOne) {\n\t\t\t\t\t\tif (rows.length) res = rows[0];\n\t\t\t\t\t\telse res = null;\n\t\t\t\t\t} else res = rows;\n\t\t\t\t}\n\t\t}\n\t\t// console.log(\"res\",res);\n\t\tif (this.def.debug) console.warn(\"res\", res);\n\t\t// console.log('The solution is: ', rows);\n\t\tif (returnCompleteRow && (this.command == \"UPDATE\" || this.command == \"INSERT\")) {\n\t\t\t// console.log(\"this.command\",this.command);\n\t\t\tif (this.command == \"UPDATE\") {\n\t\t\t\tthis.table.find(this.original_where, this.original_whereData).exec((rows2) => {\n\t\t\t\t\t// if (errsql) console.warn(\"errsql\", errsql);\n\t\t\t\t\tif (this.onlyOne) return rows2[0];\n\t\t\t\t\treturn rows2;\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tlet ftemp = {};\n\t\t\t\tftemp[this.primary] = res;\n\t\t\t\tif (!res) {\n\t\t\t\t\t// console.log(\"res\", res, this.primary, this.data);\n\t\t\t\t\tftemp[this.primary] = this.data[this.primary];\n\t\t\t\t}\n\t\t\t\tthis.table.findone(ftemp).exec((rows2) => {\n\t\t\t\t\t// if (errsql) console.warn(\"errsql\", errsql);\n\t\t\t\t\treturn rows2;\n\t\t\t\t});\n\t\t\t}\n\t\t} else return res;\n\t}\n};\n"],"file":"DbTableExec.js"}